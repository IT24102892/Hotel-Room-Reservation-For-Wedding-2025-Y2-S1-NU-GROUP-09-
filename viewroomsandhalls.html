<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>View Rooms and Halls - Luxury Haven Hotel</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #c19a6b;
            --secondary: #1a1a2e;
            --light: #f9f9f9;
            --success: #28a745;
            --danger: #dc3545;
        }
        body {
            font-family: 'Segoe UI', sans-serif;
            margin: 0;
            background-color: #f0f2f5;
            padding: 0;
        }
        .menu {
            background-color: var(--secondary);
            padding: 12px 20px;
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        .menu a {
            color: white;
            text-decoration: none;
            font-size: 15px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: color 0.3s, background 0.3s;
            padding: 8px 12px;
            border-radius: 6px;
        }
        .menu a:hover {
            background-color: var(--primary);
            color: #fff;
        }
        .container {
            max-width: 1200px;
            margin: 30px auto;
            background-color: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }
        h2 {
            color: var(--secondary);
            text-align: center;
            margin-bottom: 20px;
        }
        .filter-container {
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            justify-content: flex-end;
        }
        .filter-container select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: #fff;
            cursor: pointer;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-size: 15px;
        }
        th, td {
            padding: 12px 10px;
            border: 1px solid #eee;
            text-align: center;
        }
        th {
            background-color: var(--primary);
            color: white;
            font-weight: 600;
        }
        tr:nth-child(even) {
            background-color: #fafafa;
        }
        img {
            max-width: 100px;
            border-radius: 6px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        }
        .edit-btn {
            padding: 6px 14px;
            background-color: var(--secondary);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            text-decoration: none;
            transition: background 0.3s;
        }
        .edit-btn:hover {
            background-color: var(--primary);
        }
        .error {
            color: var(--danger);
            font-size: 14px;
            text-align: center;
            display: none;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
<!-- Navigation Menu -->
<div class="menu">
    <a href="/api/manage"><i class="fas fa-bed"></i> Manage Users</a>
    <a href="/api/rooms-halls/view"><i class="fas fa-building"></i> Edit Halls</a>
    <a href="/api/rooms-halls/add"><i class="fas fa-users"></i> Add Halls</a>
    <a href="/api/calendarview/add"><i class="fas fa-calendar-check"></i> Add Calendar View</a>
    <a href="/api/rooms-halls/view"><i class="fas fa-calendar-check"></i> Bookings</a>
    <a href="#"><i class="fas fa-chart-line"></i> Reports</a>
</div>

<!-- Page Content -->
<div class="container">
    <h2><i class="fas fa-hotel"></i> View Rooms and Halls</h2>
    <div class="error" id="errorMessage"></div>
    <div class="filter-container">
        <select id="typeFilter" onchange="fetchRoomsHalls()">
            <option value="">All Types</option>
            <option value="rooms">Rooms</option>
            <option value="halls">Halls</option>
        </select>
        <select id="acFilter" onchange="fetchRoomsHalls()">
            <option value="">All AC Options</option>
            <option value="true">Air Conditioned</option>
            <option value="false">Non-Air Conditioned</option>
        </select>
    </div>
    <table id="roomsHallsTable">
        <thead>
        <tr>
            <th>ID</th>
            <th>Type</th>
            <th>Capacity</th>
            <th>Available</th>
            <th>Air Conditioned</th>
            <th>Image</th>
            <th>Price</th>
            <th>Action</th>
        </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<script>
    async function fetchRoomsHalls() {
        const type = document.getElementById('typeFilter').value;
        const ac = document.getElementById('acFilter').value;
        const params = new URLSearchParams();
        if (type) params.append('type', type);
        if (ac) params.append('aircondition', ac);

        try {
            const response = await fetch(`http://localhost:8080/api/rooms-halls?${params.toString()}`);
            const roomsHalls = await response.json();
            const tbody = document.querySelector('#roomsHallsTable tbody');
            tbody.innerHTML = '';

            if (roomsHalls.length === 0) {
                tbody.innerHTML = `<tr><td colspan="8">No data found</td></tr>`;
                return;
            }

            roomsHalls.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${item.id}</td>
                    <td>${item.types}</td>
                    <td>${item.number}</td>
                    <td style="color:${item.available ? 'green' : 'red'};">
                        ${item.available ? 'Yes' : 'No'}
                    </td>
                    <td>${item.aircondition ? 'Yes' : 'No'}</td>
                    <td>${item.image ? `<img src="${item.image}" alt="Image">` : 'N/A'}</td>
                    <td>$${item.price}</td>
                    <td><a href="/api/rooms-halls/edit/${item.id}" class="edit-btn">
                        <i class="fas fa-edit"></i> Edit
                    </a></td>
                `;
                tbody.appendChild(row);
            });
        } catch (error) {
            showError('Failed to load rooms and halls: ' + error.message);
        }
    }

    function showError(message) {
        const errorDiv = document.getElementById('errorMessage');
        errorDiv.textContent = message;
        errorDiv.style.display = 'block';
        setTimeout(() => errorDiv.style.display = 'none', 5000);
    }

    document.addEventListener('DOMContentLoaded', fetchRoomsHalls);
</script>
</body>
</html>
